(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-384a966c"],{"23f9":function(e,t,s){},"4aee":function(e,t,s){"use strict";s("74fd")},"4ffd":function(e,t,s){e.exports=s.p+"img/logo.1e1fd7d9.png"},"6de9":function(e,t,s){"use strict";s("23f9")},"74fd":function(e,t,s){},dd7b:function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{style:e.bgStyle,attrs:{id:"login"}},[s("div",{attrs:{id:"login-from"}},[s("el-avatar",{staticStyle:{"margin-left":"110px"},attrs:{size:80,src:e.logoUrl}}),s("div",{staticClass:"title"},[e._v("登录项目管理系统")]),s("login-from",{ref:"loginfrom",on:{userlogin:e.login}}),s("div",{staticClass:"create-account"},[e._v(" 人脸识别登录 "),s("el-link",{attrs:{type:"primary"},on:{click:e.handleFaceLogin}},[e._v("点击识别")]),s("br"),e._v(" 没有账号？ "),s("el-link",{attrs:{type:"primary"},on:{click:e.toCreateAccount}},[e._v("点击注册")])],1)],1),s("el-dialog",{attrs:{title:"人脸识别登录",fullscreen:!0,visible:e.isFaceLogin},on:{"update:visible":function(t){e.isFaceLogin=t}}},[s("div",{staticStyle:{"text-align":"center"}},[s("el-form",{attrs:{"label-width":"auto",inline:""}},[s("el-form-item",{attrs:{label:"用户名"}},[s("el-input",{attrs:{id:"username"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1)],1)],1),s("face-connect",{ref:"faceConnect",attrs:{"is-show-button":!1,"is-show-progress":!1,"img-save-times":200,"need-img-count":10},on:{imgConnected:e.faceLogin}}),s("div",{staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{type:"warning",size:"mini"},on:{click:e.handleResetFaceLogin}},[e._v(" 重置 ")]),s("el-button",{attrs:{type:"primary",size:"mini",disabled:e.isStartFaceLogin},on:{click:e.handleStartFaceLogin}},[e._v(" 开始识别登录 ")])],1)],1)],1)},i=[],r=(s("d3b7"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"login-from"},[s("el-form",{ref:"loginForm",attrs:{model:e.form,rules:e.rules}},[s("div",{staticClass:"login-from-item"},[s("label",{attrs:{for:"username"}},[e._v(" Username or email address ")]),s("el-form-item",{attrs:{prop:"username"}},[s("el-input",{attrs:{id:"username",placeholder:"请输入用户名",size:"small"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1)],1),s("div",{staticClass:"login-from-item"},[s("label",{staticStyle:{position:"relative"},attrs:{for:"password"}},[e._v(" Password "),s("el-link",{staticStyle:{position:"absolute",right:"2px"},attrs:{type:"danger"}},[e._v("忘记密码？")])],1),s("el-form-item",{attrs:{prop:"password"}},[s("el-input",{attrs:{id:"password",placeholder:"请输入密码",size:"small","show-password":""},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1)],1),s("div",{staticClass:"login-from-item"},[s("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",round:""},on:{click:e.login}},[e._v("登录")])],1)])],1)}),o=[],a={name:"LoginFrom",data:function(){return{form:{username:"",password:""},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:6,max:14,message:"长度在 6 到 14 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:16,message:"长度在 6 到 16 个字符",trigger:"blur"}]}}},methods:{login:function(){var e=this;this.$refs["loginForm"].validate((function(t){if(!t)return!1;e.$emit("userlogin",e.form)}))}}},l=a,c=(s("4aee"),s("2877")),u=Object(c["a"])(l,r,o,!1,null,"5509ba49",null),m=u.exports,f=s("8d85"),d=s("4ba1"),g=s("c5ab"),p=s("b5e1"),h=s("f68f"),b={name:"login",components:{FaceConnect:p["a"],LoginFrom:m},data:function(){return{isFaceLogin:!1,bgStyle:g["c"],logoUrl:s("4ffd"),createAccountPath:"/createaccount",username:"",isStartFaceLogin:!1}},methods:{handleStartFaceLogin:function(){""!==this.username&&null!=this.username?(this.isStartFaceLogin=!0,this.$refs.faceConnect.startConnect()):this.$message.error("请输入用户名")},handleResetFaceLogin:function(){this.isStartFaceLogin=!1,this.$refs.faceConnect.reset()},handleFaceLogin:function(){this.$refs.loginfrom.username=this.username,this.isFaceLogin=!0},toCreateAccount:function(){this.$router.push(this.createAccountPath)},faceLogin:function(e){var t=this,s=JSON.stringify(e);if(""!==this.username&&null!=this.username){var n=this.$loading({lock:!0,text:"正在对比人脸信息",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});Object(h["b"])(this.username,s).then((function(e){if(console.log(e),200===e.code){var s=e.result;t.$store.commit(d["d"],s),t.$message.success("登录成功，即将进入系统"),setTimeout((function(){Object(f["c"])(s.userIdStr).then((function(e){if(200===e.code){var s=e.result;t.$router.push("/index"),t.$store.commit(d["c"],{loginUser:s})}else t.$message("验证用户失败")}))}),1500),t.$router.push("/introduce")}else t.$message("登录失败,"+e.msg)})).finally((function(){n.close()}))}else this.$alert("用户名不能为空")},login:function(e){var t=this,s=e.username,n=e.password,i=this.$loading({lock:!0,text:"正在登录",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});Object(f["d"])(s,n).then((function(e){if(200===e.code){var s=e.result;t.$store.commit(d["d"],s),t.$message.success("登录成功，即将进入系统"),setTimeout((function(){Object(f["c"])(s.userIdStr).then((function(e){if(200===e.code){var s=e.result;t.$router.push("/index"),t.$store.commit(d["c"],{loginUser:s})}else t.$message("验证用户失败")}))}),1500)}else t.$message.error("登录失败, "+e.msg)})).catch((function(e){t.$message.error("出错拉,检查网络试试或联系管理员")})).finally((function(){i.close()}))}}},v=b,$=(s("6de9"),Object(c["a"])(v,n,i,!1,null,"284f2c98",null));t["default"]=$.exports}}]);
//# sourceMappingURL=chunk-384a966c.1502bd95.js.map